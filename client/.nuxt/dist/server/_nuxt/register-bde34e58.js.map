{"version":3,"file":"register-bde34e58.js","sources":["../../../../pages/register.vue"],"sourcesContent":["<template>\n    <div class=\"authentication\">\n        <div class=\"container d-flex flex-column\">\n            <div class=\"row align-items-center justify-content-center no-gutters min-vh-100\">\n                <div class=\"col-12 col-md-7 col-lg-5 col-xl-4 py-md-11\">\n                    <div class=\"card border-0 shadow-sm\">\n                        <div class=\"card-body\">\n\n                            <h3 class=\"text-center\">注册</h3>\n\n                            <p class=\"text-center mb-6\">创建一个免费账户</p>\n                            <el-form\n                                ref=\"ruleFormRef\"\n                                :model=\"ruleForm\"\n                                :rules=\"rules\"\n                                class=\"demo-ruleForm\"\n                                status-icon\n                            >\n                                <el-form-item prop=\"name\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"text\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.name\"\n                                               placeholder=\"填写您的用户名\">\n                                    </div>\n                                </el-form-item>\n                                <el-form-item prop=\"email\">\n                                        <div class=\"input-group mb-2\">\n                                            <input type=\"email\" class=\"form-control form-control-lg\"\n                                                   v-model=\"ruleForm.email\"\n                                                   placeholder=\"请填写您的邮箱\">\n                                        </div>\n                                </el-form-item>\n                                <el-form-item prop=\"email_code\">\n                                    <el-col :span=\"16\">\n                                        <div class=\"input-group mb-2\">\n                                            <input type=\"email\" class=\"form-control form-control-lg\"\n                                                   v-model=\"ruleForm.email_code\"\n                                                   placeholder=\"请填写您的邮箱验证码\">\n                                        </div>\n                                    </el-col>\n                                    <el-col :span=\"6\" class=\"text-center\">\n                                        <div class=\"input-group mb-2 ml-2\">\n                                            <el-button type=\"primary\" class=\"form-control form-control-lg pd-2\" @click=\"send_code()\">发送验证码</el-button>\n                                        </div>\n\n                                    </el-col>\n\n                                </el-form-item>\n                                <el-form-item prop=\"password\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"password\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.password\"\n                                               placeholder=\"填写您的密码\">\n                                    </div>\n                                </el-form-item>\n                                <el-form-item prop=\"invite_code\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"invite_code\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.invite_code\"\n                                               placeholder=\"填写您的邀请码（可选）\">\n                                    </div>\n                                </el-form-item>\n                                <el-form-item>\n                                    <el-button type=\"primary\" :loading=\"reg_loading\" class=\"register\" size=\"large\" @click=\"submitForm(ruleFormRef)\">\n                                        注册\n                                    </el-button>\n                                </el-form-item>\n                            </el-form>\n\n\n                            <p class=\"text-center mb-0\">已经有账户了? <NuxtLink class=\"link\" to=\"/login\">登录</NuxtLink>.</p>\n\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\n\nimport {send_email} from \"~/utils/api\";\nimport { useCounter } from '~/store/counter'\nconst counter = useCounter()\n\nuseHead({\n    title: '注册 - '+counter.setting.title,\n    meta: [\n        { name: 'description', content: counter.setting.description},\n        { name: 'keywords', content: counter.setting.keywords}\n    ]\n})\ndefinePageMeta({\n    layout: false,\n    middleware: ['auth']\n})\nimport { reactive, ref } from 'vue'\nimport type { FormInstance, FormRules } from 'element-plus'\nimport {ElMessage} from \"element-plus\";\nconst ruleFormRef = ref<FormInstance>()\nconst ruleForm = reactive({\n    name: '',\n    email: '',\n    password: '',\n    email_code: '',\n    invite_code: ''\n})\n\nconst rules = reactive<FormRules>({\n    name: [\n        { required: true, message: '请输入用户名', trigger: 'blur' },\n    ],\n    email: [\n        { required: true, message: '请输入邮箱地址', trigger: 'blur' },\n        { type: 'email', message: '请输入正确的邮箱地址', trigger: ['blur', 'change'] }\n    ],\n    password: [\n        { required: true, message: '请输入密码', trigger: 'blur' },\n    ],\n    email_code: [\n        { required: true, message: '请输入邮箱验证码', trigger: 'blur' },\n    ],\n})\nconst router = useRouter()\nconst reg_loading = ref(false)\nconst submitForm = async (formEl: FormInstance | undefined) => {\n    if (!formEl) return\n    await formEl.validate((valid, fields) => {\n        if (valid) {\n            reg_loading.value = true\n            register({\n                name: ruleForm.name,\n                email: ruleForm.email,\n                password: ruleForm.password,\n                email_code: ruleForm.email_code,\n                invite_code: ruleForm.invite_code\n            }).then((res:any) => {\n                if (res._rawValue.status==200){\n                    ElMessage.success(res._rawValue.message)\n                    formEl.resetFields()\n                    router.push({path:'/login'})\n                    reg_loading.value = false\n                }\n\n            }).catch((err:any) => {\n                reg_loading.value = false\n            })\n        } else {\n            console.log('error submit!', fields)\n        }\n    })\n}\n\nconst send_code = () => {\n    if (ruleForm.email==''){\n        ElMessage.error('请填写邮箱')\n        return\n    }\n    send_email({\n        email: ruleForm.email\n    }).then((res:any) => {\n        if (res._rawValue.status==200){\n            ElMessage.success(res._rawValue.message)\n        }\n    }).catch((err:any) => {\n        console.log(err)\n    })\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"names":["useHead","title","meta","name","content","email","password","email_code","invite_code","required","message","trigger","type","register","path","console","ElMessage","send_email"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuFQA,YAAAA;AAAAA,MACJC,OAAAA,UAAAA,QAAAA,QAAAA;AAAAA,MACAC,MAAAA,CAAAA;AAAAA,QACMC,MAAAA;AAAAA,QAAqBC,SAAAA,QAAAA,QAAAA;AAAAA,MAAoC,GAAA;AAAA,QACzDD,MAAAA;AAAAA,QAAkBC,SAAAA,QAAAA,QAAAA;AAAAA;IAE5B,CAAA;;;MAUID,MAAAA;AAAAA,MACAE,OAAAA;AAAAA,MACAC,UAAAA;AAAAA,MACAC,YAAAA;AAAAA,MACAC,aAAAA;AAAAA,IACJ,CAAA;;MAGIL,MAAAA,CAAAA;AAAAA,QACMM,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAmBC,SAAAA;AAAAA,MAAgB,CAAA;AAAA,MAEzDN,OAAAA,CAAAA;AAAAA,QACMI,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAoBC,SAAAA;AAAAA,MAAgB,GAAA;AAAA,QACpDC,MAAAA;AAAAA,QAAeF,SAAAA;AAAAA,QAAuBC,SAAAA,CAAAA,QAAAA,QAAAA;AAAAA,MAA4B,CAAA;AAAA,MAExEL,UAAAA,CAAAA;AAAAA,QACMG,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAkBC,SAAAA;AAAAA,MAAgB,CAAA;AAAA,MAExDJ,YAAAA,CAAAA;AAAAA,QACME,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAqBC,SAAAA;AAAAA;IAE/C,CAAA;;AAEM,UAAA,cAAA,IAAA,KAAA;AACA,UAAA,aAAA,OAAA,WAAA;;;;AAGE,YAAA,OAAA;;AAEaE,mBAAAA;AAAAA;;;;;UAMT,CAAA,EAAA,KAAA,SAAA;AACQ,gBAAA,IAAA,UAAA,UAAA,KAAA;;;;gBAGaC,MAAAA;AAAAA,cAAa,CAAA;;YAE9B;AAAA,UAEJ,CAAA,EAAA,MAAA,SAAA;;UAEA,CAAA;AAAA,QACJ,OAAA;AACYC,kBAAAA,IAAAA,iBAAAA,MAAAA;AAAAA,QACZ;AAAA,MACJ,CAAA;AAAA;;AAII,UAAA,SAAA,SAAA,IAAA;AACAC,kBAAAA,MAAAA,OAAAA;AACA;AAAA,MACJ;AACWC,iBAAAA;AAAAA;MAEX,CAAA,EAAA,KAAA,SAAA;AACQ,YAAA,IAAA,UAAA,UAAA,KAAA;;QAEJ;AAAA,MACJ,CAAA,EAAA,MAAA,SAAA;AACIF,gBAAAA,IAAAA,GAAAA;AAAAA,MACJ,CAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}