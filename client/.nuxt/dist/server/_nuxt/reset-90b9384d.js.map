{"version":3,"file":"reset-90b9384d.js","sources":["../../../../pages/users/reset.vue"],"sourcesContent":["<template>\n    <div class=\"authentication\">\n        <div class=\"container d-flex flex-column\">\n            <div class=\"row align-items-center justify-content-center no-gutters min-vh-100\">\n                <div class=\"col-12 col-md-7 col-lg-5 col-xl-4 py-md-11\">\n                    <div class=\"card border-0 shadow-sm\">\n                        <div class=\"card-body\">\n\n                            <h3 class=\"text-center\">重置密码</h3>\n\n                            <p class=\"text-center mb-6\">\n                                请在下面输入你的电子邮件地址，并且发送验证码到你的邮箱。\n                            </p>\n\n                            <el-form\n                                ref=\"ruleFormRef\"\n                                :model=\"ruleForm\"\n                                :rules=\"rules\"\n                                class=\"demo-ruleForm\"\n                                status-icon\n                            >\n\n                                <el-form-item prop=\"email\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"email\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.email\"\n                                               placeholder=\"请填写您的邮箱\">\n                                    </div>\n                                </el-form-item>\n                                <el-form-item prop=\"email_code\">\n                                    <el-col :span=\"16\">\n                                        <div class=\"input-group mb-2\">\n                                            <input type=\"email\" class=\"form-control form-control-lg\"\n                                                   v-model=\"ruleForm.email_code\"\n                                                   placeholder=\"请填写您的邮箱验证码\">\n                                        </div>\n                                    </el-col>\n                                    <el-col :span=\"6\" class=\"text-center\">\n                                        <div class=\"input-group mb-2 ml-2\">\n                                            <el-button type=\"primary\" class=\"form-control form-control-lg pd-2\" @click=\"send_code()\">发送验证码</el-button>\n                                        </div>\n\n                                    </el-col>\n\n                                </el-form-item>\n                                <el-form-item prop=\"password\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"password\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.password\"\n                                               placeholder=\"填写您的密码\">\n                                    </div>\n                                </el-form-item>\n\n                                <el-form-item prop=\"password\">\n                                    <div class=\"input-group mb-2\">\n                                        <input type=\"password\" class=\"form-control form-control-lg\"\n                                               v-model=\"ruleForm.password_c\"\n                                               placeholder=\"确认您的密码\">\n                                    </div>\n                                </el-form-item>\n\n                                <el-form-item>\n                                    <el-button type=\"primary\" :loading=\"pass_loading\" class=\"register\" size=\"large\" @click=\"submitForm(ruleFormRef)\">\n                                        重置密码\n                                    </el-button>\n                                </el-form-item>\n                            </el-form>\n\n                            <p class=\"text-center mb-0\">已经有账户了？<NuxtLink class=\"link\" to=\"/login\">登录</NuxtLink>.</p>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {reset_password, send_email} from \"~/utils/api\";\nimport { useCounter } from '~/store/counter'\nconst counter = useCounter()\n\nuseHead({\n    title: '重置密码 - '+counter.setting.title,\n    meta: [\n        { name: 'description', content: counter.setting.description},\n        { name: 'keywords', content: counter.setting.keywords}\n    ]\n})\ndefinePageMeta({\n    layout: false\n})\nimport type { FormInstance, FormRules } from 'element-plus'\nimport { ref,reactive } from 'vue'\nimport {ElMessage} from \"element-plus\";\nconst ruleFormRef = ref<FormInstance>()\nconst ruleForm = reactive({\n    email: '',\n    email_code: '',\n    password: '',\n    password_c: ''\n})\nconst rules = reactive<FormRules>({\n    email: [\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\n        { type: 'email', message: '请输入正确的邮箱地址', trigger: ['blur', 'change'] }\n    ],\n    email_code: [\n        { required: true, message: '请输入邮箱验证码', trigger: 'blur' },\n    ],\n    password: [\n        { required: true, message: '请输入密码', trigger: 'blur' },\n        { min: 8, message: '密码长度不能小于8位', trigger: 'blur' },\n    ],\n    password_c: [\n        { required: true, message: '请确认密码', trigger: 'blur' },\n        { min: 8, message: '密码长度不能小于8位', trigger: 'blur' },\n    ],\n})\nconst router = useRouter()\nconst pass_loading = ref(false)\nconst submitForm = async (formEl: FormInstance | undefined) => {\n    if (!formEl) return\n    await formEl.validate((valid, fields) => {\n        if (valid) {\n            if (ruleForm.password!=ruleForm.password_c){\n                ElMessage.error('两次密码不一致')\n                return\n            }\n            pass_loading.value = true\n            reset_password({\n                email: ruleForm.email,\n                email_code: ruleForm.email_code,\n                password: ruleForm.password,\n            }).then((res:any) => {\n                if (res._rawValue.status==200){\n                    ElMessage.success(res._rawValue.message)\n                    formEl.resetFields()\n                    router.push({path:'/login'})\n                    pass_loading.value = false\n                }\n\n            }).catch((err:any) => {\n                pass_loading.value = false\n                ElMessage.error(err.message)\n            })\n        } else {\n            console.log('error submit!', fields)\n        }\n    })\n}\nconst send_code = () => {\n    if (ruleForm.email==''){\n        ElMessage.error('请填写邮箱')\n        return\n    }\n    send_email({\n        email: ruleForm.email\n    }).then((res:any) => {\n        if (res._rawValue.status==200){\n            ElMessage.success(res._rawValue.message)\n        }\n    }).catch((err:any) => {\n        ElMessage.error(err.message)\n    })\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"names":["useHead","title","meta","name","content","email","email_code","password","password_c","required","message","trigger","type","min","ElMessage","reset_password","path","console","send_email"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFQA,YAAAA;AAAAA,MACJC,OAAAA,YAAAA,QAAAA,QAAAA;AAAAA,MACAC,MAAAA,CAAAA;AAAAA,QACMC,MAAAA;AAAAA,QAAqBC,SAAAA,QAAAA,QAAAA;AAAAA,MAAoC,GAAA;AAAA,QACzDD,MAAAA;AAAAA,QAAkBC,SAAAA,QAAAA,QAAAA;AAAAA;IAE5B,CAAA;;;MASIC,OAAAA;AAAAA,MACAC,YAAAA;AAAAA,MACAC,UAAAA;AAAAA,MACAC,YAAAA;AAAAA,IACJ,CAAA;;MAEIH,OAAAA,CAAAA;AAAAA,QACMI,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAkBC,SAAAA;AAAAA,MAAgB,GAAA;AAAA,QAClDC,MAAAA;AAAAA,QAAeF,SAAAA;AAAAA,QAAuBC,SAAAA,CAAAA,QAAAA,QAAAA;AAAAA,MAA4B,CAAA;AAAA,MAExEL,YAAAA,CAAAA;AAAAA,QACMG,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAqBC,SAAAA;AAAAA,MAAgB,CAAA;AAAA,MAE3DJ,UAAAA,CAAAA;AAAAA,QACME,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAkBC,SAAAA;AAAAA,MAAgB,GAAA;AAAA,QAClDE,KAAAA;AAAAA,QAAQH,SAAAA;AAAAA,QAAuBC,SAAAA;AAAAA,MAAgB,CAAA;AAAA,MAErDH,YAAAA,CAAAA;AAAAA,QACMC,UAAAA;AAAAA,QAAgBC,SAAAA;AAAAA,QAAkBC,SAAAA;AAAAA,MAAgB,GAAA;AAAA,QAClDE,KAAAA;AAAAA,QAAQH,SAAAA;AAAAA,QAAuBC,SAAAA;AAAAA;IAEzC,CAAA;;AAEM,UAAA,eAAA,IAAA,KAAA;AACA,UAAA,aAAA,OAAA,WAAA;;;;AAGE,YAAA,OAAA;AACQ,cAAA,SAAA,YAAA,SAAA,YAAA;AACAG,sBAAAA,MAAAA,SAAAA;AACA;AAAA,UACJ;;AAEeC,yBAAAA;AAAAA;;;UAIf,CAAA,EAAA,KAAA,SAAA;AACQ,gBAAA,IAAA,UAAA,UAAA,KAAA;;;;gBAGaC,MAAAA;AAAAA,cAAa,CAAA;;YAE9B;AAAA,UAEJ,CAAA,EAAA,MAAA,SAAA;;AAEcF,sBAAAA,MAAAA,IAAAA,OAAAA;AAAAA,UACd,CAAA;AAAA,QACJ,OAAA;AACYG,kBAAAA,IAAAA,iBAAAA,MAAAA;AAAAA,QACZ;AAAA,MACJ,CAAA;AAAA;;AAGI,UAAA,SAAA,SAAA,IAAA;AACAH,kBAAAA,MAAAA,OAAAA;AACA;AAAA,MACJ;AACWI,iBAAAA;AAAAA;MAEX,CAAA,EAAA,KAAA,SAAA;AACQ,YAAA,IAAA,UAAA,UAAA,KAAA;;QAEJ;AAAA,MACJ,CAAA,EAAA,MAAA,SAAA;AACcJ,kBAAAA,MAAAA,IAAAA,OAAAA;AAAAA,MACd,CAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}